<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ParkGO - Dashboard con Animaciones</title>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Font Awesome 6 (√≠conos visibles) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    :root {
      --accent: #0078d7;
      --bg: #f4f6f9;
      --card: #ffffff;
      --text: #222;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      background: var(--bg);
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      color: var(--text);
      text-align: center;
      overflow-x: hidden;
    }

    /* üîπ Animaciones */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes zoomIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }

    .fade { animation: fadeIn 1s ease forwards; }
    .zoom { animation: zoomIn 1.2s ease forwards; }

    /* üîπ ENCABEZADO */
    header {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
      background: var(--accent);
      color: #fff;
      padding: 12px 16px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
    }
    header img {
      height: 60px;
      width: auto;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
    }
    header h1 {
      margin: 0;
      font-size: 2rem;
      font-weight: 700;
    }

    p.subtitle {
      margin: 12px 0 24px;
      color: #444;
      font-size: 1.1rem;
    }

    /* üîπ TABLAS */
    .tables {
      display: flex;
      flex-direction: column;
      gap: 18px;
      align-items: center;
      width: 100%;
      max-width: 1100px;
      margin: 0 auto 28px;
      padding: 0 14px;
    }
    .big-table {
      width: 100%;
      background: var(--card);
      border-radius: 14px;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
      overflow: hidden;
      opacity: 0;
    }
    .big-table.show { opacity: 1; animation: fadeIn 1s ease forwards; }

    .big-table table {
      width: 100%;
      border-collapse: collapse;
      font-size: 1.1rem;
    }
    .big-table thead th {
      text-align: left;
      padding: 18px 22px;
      background: var(--accent);
      color: #fff;
      font-size: 1.2rem;
    }
    .big-table tbody td {
      padding: 20px;
      border-top: 1px solid #eee;
    }
    .valor {
      font-weight: 700;
      color: var(--accent);
      font-size: 1.7rem;
    }
    .fecha {
      color: #555;
      font-size: 0.95rem;
    }

    /* üîπ GR√ÅFICAS */
    .charts {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto 40px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 24px;
      padding: 0 14px;
    }
    @media (min-width: 900px) {
      .charts { grid-template-columns: 1fr 1fr; }
    }
    .chart-card {
      background: var(--card);
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.07);
      padding: 18px;
      transform: scale(0.9);
      opacity: 0;
    }
    .chart-card.show { opacity: 1; animation: zoomIn 1s ease forwards; }

    .chart-title {
      text-align: left;
      color: var(--accent);
      font-weight: 700;
      margin-bottom: 8px;
      font-size: 1.1rem;
    }
    canvas {
      width: 100% !important;
      height: 360px !important;
    }

    /* üîπ FOOTER */
    footer {
      background: var(--accent);
      color: #fff;
      padding: 16px 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    .social {
      display: flex;
      gap: 20px;
    }
    .social a {
      color: #fff;
      font-size: 1.8rem;
      transition: transform 0.2s ease, color 0.2s ease;
    }
    .social a:hover {
      transform: scale(1.2);
      color: #ffd700;
    }
    footer p {
      margin: 0;
      font-size: 0.95rem;
    }
  </style>
</head>

<body>
  <!-- üîπ ENCABEZADO -->
  <header>
    <img src="LOGO-ITEC-PARA-WEB_1.png" alt="Logo ParkGO" />
    <h1>ParkGO</h1>
  </header>

  <p class="subtitle">Visualizaci√≥n en tiempo real </p>

  <!-- üîπ TABLAS -->
  <section class="tables fade">
    <div class="big-table"><table>
      <thead><tr><th>Aperturas de Barrera</th><th>√öltima fecha</th></tr></thead>
      <tbody><tr><td class="valor" id="aperturas">--</td><td class="fecha" id="fecha1">--</td></tr></tbody>
    </table></div>
    <div class="big-table"><table>
      <thead><tr><th>Cierres de Barrera</th><th>√öltima fecha</th></tr></thead>
      <tbody><tr><td class="valor" id="cierres">--</td><td class="fecha" id="fecha2">--</td></tr></tbody>
    </table></div>
    <div class="big-table"><table>
      <thead><tr><th>Tiempo Total (segundos)</th><th>√öltima fecha</th></tr></thead>
      <tbody><tr><td class="valor" id="tiempo">--</td><td class="fecha" id="fecha3">--</td></tr></tbody>
    </table></div>
    <div class="big-table"><table>
      <thead><tr><th>Ganancia Total ($)</th><th>√öltima fecha</th></tr></thead>
      <tbody><tr><td class="valor" id="ganancia">--</td><td class="fecha" id="fecha4">--</td></tr></tbody>
    </table></div>
  </section>

  <!-- üîπ GR√ÅFICAS -->
  <section class="charts">
    <div class="chart-card"><div class="chart-title">Aperturas de Barrera</div><canvas id="chartA"></canvas></div>
    <div class="chart-card"><div class="chart-title">Cierres de Barrera</div><canvas id="chartB"></canvas></div>
    <div class="chart-card"><div class="chart-title">Tiempo Total (s)</div><canvas id="chartC"></canvas></div>
    <div class="chart-card"><div class="chart-title">Ganancia Total ($)</div><canvas id="chartD"></canvas></div>
  </section>

  <!-- üîπ FOOTER -->
  <footer class="fade">
    <div class="social">
      <a href="https://www.instagram.com/parkgo.srl/" target="_blank"><i class="fab fa-instagram"></i></a>
      <a href="https://www.tiktok.com/@parkgo" target="_blank"><i class="fab fa-tiktok"></i></a>
    </div>
    <p>¬© 2025 ParkGO ‚Ä¢ Garcia,Martin. Guberti,Lorenzo. Lamberto,Aldo. Landaburu,Lisandro</p>
  </footer>

  <script>
    const channelID = 3111541;
    const readAPIKey = "Y65MRQAJGMM1TSXG";
    const RESULTS = 30;
    const baseUrl = `https://api.thingspeak.com/channels/${channelID}/feeds.json?api_key=${readAPIKey}&results=${RESULTS}`;

    function makeBarChart(ctx, label, color){
      return new Chart(ctx,{
        type:'bar',
        data:{labels:[],datasets:[{label:label,data:[],backgroundColor:color,borderRadius:6}]},
        options:{
          responsive:true,maintainAspectRatio:false,
          scales:{x:{grid:{display:false}},y:{beginAtZero:true}},
          plugins:{legend:{display:false}}
        }
      });
    }

    const chartA=makeBarChart(document.getElementById('chartA').getContext('2d'),'Aperturas','#0078d7');
    const chartB=makeBarChart(document.getElementById('chartB').getContext('2d'),'Cierres','#d9534f');
    const chartC=makeBarChart(document.getElementById('chartC').getContext('2d'),'Tiempo','#28a745');
    const chartD=makeBarChart(document.getElementById('chartD').getContext('2d'),'Ganancia','#ff9f00');

    async function actualizar(){
      try{
        const res=await fetch(baseUrl);
        const data=await res.json();
        const feeds=data.feeds;
        if(!feeds||feeds.length===0)return;
        const ultimo=feeds[feeds.length-1];
        const fecha=new Date(ultimo.created_at).toLocaleString();

        document.getElementById('aperturas').textContent=ultimo.field1||0;
        document.getElementById('fecha1').textContent=fecha;
        document.getElementById('cierres').textContent=ultimo.field2||0;
        document.getElementById('fecha2').textContent=fecha;
        document.getElementById('tiempo').textContent=ultimo.field3||0;
        document.getElementById('fecha3').textContent=fecha;
        document.getElementById('ganancia').textContent='$'+(ultimo.field4||0);
        document.getElementById('fecha4').textContent=fecha;

        const labels=feeds.map(f=>new Date(f.created_at).toLocaleTimeString());
        update(chartA,labels,feeds.map(f=>Number(f.field1)));
        update(chartB,labels,feeds.map(f=>Number(f.field2)));
        update(chartC,labels,feeds.map(f=>Number(f.field3)));
        update(chartD,labels,feeds.map(f=>Number(f.field4)));

        document.querySelectorAll('.big-table, .chart-card').forEach(el=>el.classList.add('show'));
      }catch(e){console.error(e);}
    }

    function update(chart,labels,data){
      chart.data.labels=labels;
      chart.data.datasets[0].data=data;
      chart.update();
    }

    actualizar();
    setInterval(actualizar,15000);
  </script>
</body>
</html>
